<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenFred.ai</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <meta name="description" content="ææ€–åœ–ç‰‡ç”Ÿæˆç¶²">
    
    <!-- Google Analytics - æš«æ™‚è¨»é‡‹ï¼Œç­‰æœ‰æ­£ç¢ºIDå†å•Ÿç”¨ -->
    <!--
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XXXXXXXXXX');
    </script>
    -->
</head>
<body>
    <header>
        <div class="logo">
            <img src="logo.png" alt="GenHorror.ai" class="logo-image">
        </div>
        
        <button class="hamburger-menu" id="hamburgerMenu">
            <span></span>
            <span></span>
            <span></span>
        </button>
        
        <nav class="nav-links" id="navLinks">
            <a href="#" class="active" data-translate="é¦–é ">é¦–é </a>
            <a href="#gallery" data-translate="ç•«å»Š">ç•«å»Š</a>
            
            <select class="language-select" id="language-select">
                <option value="en" data-text="English">ğŸ‡ºğŸ‡¸ English</option>
                <option value="es" data-text="EspaÃ±ol">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                <option value="de" data-text="Deutsch">ğŸ‡©ğŸ‡ª Deutsch</option>
                <option value="ja" data-text="æ—¥æœ¬èª">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                <option value="zh" data-text="ä¸­æ–‡">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
            </select>
            
            <button id="login-btn" class="btn-login" data-translate="ç™»å…¥">ç™»å…¥</button>
            <button id="pay-button" class="btn-premium" data-translate="å‡ç´šæ–¹æ¡ˆ">å‡ç´šæ–¹æ¡ˆ</button>

            <!-- ç”¨æˆ¶ä¿¡æ¯å°‡åœ¨é€™è£¡å‹•æ…‹é¡¯ç¤º -->
        </nav>
    </header>

    <section class="hero">
        <!-- <img src="src/01-hero.jpg" alt="Hero Background" class="hero-bg"> -->
        <div class="container">
            <h2 data-translate="å°‡æ‚¨çš„æƒ³æ³•è½‰åŒ–ç‚ºç²¾ç¾åœ–åƒ">å°‡æ‚¨çš„æƒ³æ³•è½‰åŒ–ç‚ºç²¾ç¾åœ–åƒ</h2>
            <p data-translate="å…è²»ã€ç„¡é™åˆ¶ã€ç„¡éœ€è¨»å†Šï¼Œç«‹å³é–‹å§‹å‰µä½œï¼">å…è²»ã€ç„¡é™åˆ¶ã€ç„¡éœ€è¨»å†Šï¼Œç«‹å³é–‹å§‹å‰µä½œï¼</p>
        </div>
    </section>

    <section class="generator">
        <div class="container">
            <div class="generator-container">
                <div class="prompt-container">
                    <h3 data-translate="æè¿°æ‚¨æƒ³è¦çš„åœ–åƒ">æè¿°æ‚¨æƒ³è¦çš„åœ–åƒ</h3>
                    <textarea id="prompt" placeholder="ä¾‹å¦‚ï¼šé»‘æš—æ©Ÿæ¢°æˆ°å£«ï¼Œè³½åšæœ‹å…‹é¢¨æ ¼"></textarea>
                    
                    <div class="input-group">
                        <label data-translate="é¢¨æ ¼">é¢¨æ ¼</label>
                        <div class="style-grid" id="styleGrid">
                            <div class="style-card" data-style="retro">
                                <div class="style-card-image">
                                    <img src="src/retro.jpg" alt="Retro Style" class="style-img">
                                </div>
                                <div class="style-card-label">Retro</div>
                            </div>
                            <div class="style-card" data-style="retro-pixel">
                                <div class="style-card-image">
                                    <img src="src/pixel.jpg" alt="Pixel Style" class="style-img">
                                </div>
                                <div class="style-card-label">Pixel</div>
                            </div>
                            <div class="style-card" data-style="cyberpunk">
                                <div class="style-card-image">
                                    <img src="src/cyberpunk.jpg" alt="Cyberpunk Style" class="style-img">
                                </div>
                                <div class="style-card-label">Cyberpunk</div>
                            </div>
                            <div class="style-card" data-style="slasher">
                                <div class="style-card-image">
                                    <img src="src/80s slasher.jpg" alt="80s Slasher Style" class="style-img">
                                </div>
                                <div class="style-card-label">80's Slasher</div>
                            </div>
                        </div>
                    </div>

                    <div class="input-group">
                        <label for="aspect-ratio" data-translate="åœ–ç‰‡å°ºå¯¸">åœ–ç‰‡å°ºå¯¸</label>
                        <select id="aspect-ratio" class="input-select">
                            <option value="1:1">1:1 (æ­£æ–¹å½¢)</option>
                            <option value="16:9">16:9 (å¯¬å±)</option>
                            <option value="9:16">9:16 (å‚ç›´)</option>
                            <option value="4:3">4:3 (æ¨™æº–)</option>
                        </select>
                    </div>
                    
                    <button id="generate-btn" class="btn-primary" data-translate="ç”Ÿæˆåœ–åƒ">ç”Ÿæˆåœ–åƒ</button>
                </div>
                
                <div class="generator-preview">
                    <div class="preview-header" data-translate="é è¦½">é è¦½</div>
                    
                    <div class="preview-container">
                        <div id="loading" class="hidden">
                            <div class="spinner"></div>
                            <p data-translate="æ­£åœ¨ç”Ÿæˆæ‚¨çš„åœ–åƒ...">æ­£åœ¨ç”Ÿæˆæ‚¨çš„åœ–åƒ...</p>
                        </div>
                        
                        <!-- Circle Loading -->
                        <div id="countdown-container" class="countdown-container hidden">
                            <div class="circle-loader"></div>
                            <p data-translate="åœ–ç‰‡ç”Ÿæˆä¸­...">åœ–ç‰‡ç”Ÿæˆä¸­...</p>
                        </div>
                        
                        <div id="result" class="hidden">
                            <!-- å–®å¼µåœ–ç‰‡å°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
                        </div>
                        
                        <div class="preview-placeholder" id="preview-placeholder">
                            <p data-translate="é»æ“Šã€Œç”Ÿæˆåœ–ç‰‡ã€é–‹å§‹å‰µä½œ">é»æ“Šã€Œç”Ÿæˆåœ–ç‰‡ã€é–‹å§‹å‰µä½œ</p>
                        </div>
                    </div>
                    
                    <div class="preview-actions">
                        <button class="btn-download" id="download-btn">â¬‡ ä¸‹è¼‰</button>
                        <button class="btn-share" id="share-btn">ğŸ“¤ åˆ†äº«</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="gallery" class="gallery">
        <div class="container">
            <h2 data-translate="éˆæ„Ÿç•«å»Š">éˆæ„Ÿç•«å»Š</h2>
            <p data-translate="ç€è¦½å…¶ä»–ç”¨æˆ¶å‰µå»ºçš„ç²¾ç¾åœ–åƒï¼Œç²å–å‰µä½œéˆæ„Ÿ">ç€è¦½å…¶ä»–ç”¨æˆ¶å‰µå»ºçš„ç²¾ç¾åœ–åƒï¼Œç²å–å‰µä½œéˆæ„Ÿ</p>
            
            <div class="gallery-grid">
                <!-- é€™è£¡å°‡å‹•æ…‹åŠ è¼‰ç•«å»Šåœ–ç‰‡ -->
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <p data-translate="&copy; 2024 AI åœ–ç‰‡ç”Ÿæˆå™¨ã€‚ä¿ç•™æ‰€æœ‰æ¬Šåˆ©ã€‚">&copy; 2024 AI åœ–ç‰‡ç”Ÿæˆå™¨ã€‚ä¿ç•™æ‰€æœ‰æ¬Šåˆ©ã€‚</p>
            <div class="social">
                <a href="#"><i class="fab fa-facebook"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
    </footer>

    <!-- ç™»å…¥æ¨¡æ…‹æ¡† -->
    <div id="login-modal" class="modal hidden"> 
        <!-- modal hidden -->
        <div class="modal-content">
            <span class="close">&times;</span>
            <h5 data-translate="ç™»å…¥">ç™»å…¥</h5>
            
            <!-- Google ç™»å…¥ -->
            <div class="google-login-section">
                <button id="google-login-btn" class="google-btn">
                    <i class="fab fa-google"></i>
                    <span data-translate="ä½¿ç”¨ Google ç™»å…¥">ä½¿ç”¨ Google ç™»å…¥</span>
                </button>
            </div>

            <!-- éƒµä»¶ç™»å…¥è¡¨å–® -->
            
            <form id="login-form">
                <!-- éŒ¯èª¤è¨Šæ¯é¡¯ç¤ºå€åŸŸ -->
                <div id="login-error-message" class="error-message" style="display: none;">
                    <i class="fas fa-exclamation-circle"></i>
                    <span id="login-error-text"></span>
                </div>
                
                <div class="form-group">
                    <label for="login-email" data-translate="é›»å­éƒµä»¶">é›»å­éƒµä»¶</label>
                    <input type="email" id="login-email" required>
                </div>
                <div class="form-group">
                    <label for="login-password" data-translate="å¯†ç¢¼">å¯†ç¢¼</label>
                    <input type="password" id="login-password" required>
                </div>
                <button type="submit" class="btn-primary" data-translate="ç™»å…¥">ç™»å…¥</button>
            </form>
            
            <p class="form-footer">
                <a href="#" id="forgot-password" data-translate="å¿˜è¨˜å¯†ç¢¼ï¼Ÿ">å¿˜è¨˜å¯†ç¢¼ï¼Ÿ</a>
            </p>
            
            <p class="form-footer">
                <span data-translate="é‚„æ²’æœ‰å¸³è™Ÿï¼Ÿ">é‚„æ²’æœ‰å¸³è™Ÿï¼Ÿ</span>
                <a href="#" id="switch-to-signup" data-translate="ç«‹å³è¨»å†Š">ç«‹å³è¨»å†Š</a>
            </p>
        </div>
    </div>

    <!-- è¨»å†Šæ¨¡æ…‹æ¡† -->
    <div id="signup-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h5 data-translate="è¨»å†Š">è¨»å†Š</h5>
            
            <!-- Google è¨»å†Š -->
            <div class="google-login-section">
                <button id="google-signup-btn" class="google-btn">
                    <i class="fab fa-google"></i>
                    <span data-translate="ä½¿ç”¨ Google è¨»å†Š">ä½¿ç”¨ Google è¨»å†Š</span>
                </button>
            </div>
            
            <!-- éƒµä»¶è¨»å†Šè¡¨å–® -->
            <form id="signup-form">
                <div class="form-group">
                    <label for="signup-name" data-translate="ç”¨æˆ¶å">ç”¨æˆ¶å</label>
                    <input type="text" id="signup-name" required>
                </div>
                <div class="form-group">
                    <label for="signup-email" data-translate="é›»å­éƒµä»¶">é›»å­éƒµä»¶</label>
                    <input type="email" id="signup-email" required>
                </div>
                <div class="form-group">
                    <label for="signup-password" data-translate="å¯†ç¢¼">å¯†ç¢¼</label>
                    <input type="password" id="signup-password" required>
                </div>
                
                <!-- Email é©—è­‰ç¢¼å€åŸŸ -->
                <div class="form-group" id="verification-group" style="display: none;">
                    <label for="verification-code" data-translate="é©—è­‰ç¢¼">é©—è­‰ç¢¼</label>
                    <div class="verification-input-group">
                        <input type="text" id="verification-code" placeholder="è«‹è¼¸å…¥6ä½æ•¸é©—è­‰ç¢¼" maxlength="6">
                        <button type="button" id="send-verification-btn" class="btn-secondary" data-translate="ç™¼é€é©—è­‰ç¢¼">ç™¼é€é©—è­‰ç¢¼</button>
                    </div>
                    <div class="verification-status" id="verification-status" style="display: none;">
                        <span id="verification-message"></span>
                        <button type="button" id="resend-verification-btn" class="btn-link" data-translate="é‡æ–°ç™¼é€" style="display: none;">é‡æ–°ç™¼é€</button>
                    </div>
                </div>
                
                <button type="submit" class="btn-primary" data-translate="è¨»å†Š">è¨»å†Š</button>
            </form>
            
            <p class="form-footer">
                <span data-translate="å·²æœ‰å¸³è™Ÿï¼Ÿ">å·²æœ‰å¸³è™Ÿï¼Ÿ</span>
                <a href="#" id="switch-to-login" data-translate="ç«‹å³ç™»å…¥">ç«‹å³ç™»å…¥</a>
            </p>
        </div>
    </div>

    <!-- ç”¨æˆ¶é¢æ¿æ¨¡æ…‹æ¡† -->
    <div id="user-panel-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 data-translate="ç”¨æˆ¶é¢æ¿">ç”¨æˆ¶é¢æ¿</h2>
            <div class="user-info">
                <div class="user-avatar-section">
                    <img id="user-avatar" src="" alt="ç”¨æˆ¶é ­åƒ" class="user-avatar">
                    <div>
                        <p data-translate="æ­¡è¿å›ä¾†">æ­¡è¿å›ä¾†ï¼</p>
                        <p><strong id="user-name"></strong></p>
                        <p id="user-email" class="user-email"></p>
                    </div>
                </div>
                
                <div class="user-stats">
                    <h4 data-translate="ç”Ÿæˆçµ±è¨ˆ">ç”Ÿæˆçµ±è¨ˆ</h4>
                    <div id="user-stats">
                        <!-- çµ±è¨ˆä¿¡æ¯å°‡åœ¨é€™è£¡å‹•æ…‹é¡¯ç¤º -->
                    </div>
                </div>
            </div>
            
            <div class="user-history">
                <h4 data-translate="æœ€è¿‘ç”Ÿæˆè¨˜éŒ„">æœ€è¿‘ç”Ÿæˆè¨˜éŒ„</h4>
                <div id="history-list" class="history-list">
                    <!-- æ­·å²è¨˜éŒ„å°‡åœ¨é€™è£¡å‹•æ…‹é¡¯ç¤º -->
                </div>
            </div>
            
            <div class="user-actions">
                <button id="logout-btn" class="btn-secondary" data-translate="ç™»å‡º">ç™»å‡º</button>
                <button id="buy-credits-btn" class="btn-primary" data-translate="å‡ç´šæ–¹æ¡ˆ">å‡ç´šæ–¹æ¡ˆ</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <script>
        // Firebase é…ç½®
        const firebaseConfig = {
            apiKey: "AIzaSyAO9j3fqIuuwwf2znCBba1af7SW6Be7Tn4",
            authDomain: "genfeer-ai.firebaseapp.com",
            projectId: "genfeer-ai",
            storageBucket: "genfeer-ai.firebasestorage.app",
            messagingSenderId: "788596046031",
            appId: "1:788596046031:web:ff880f82c1d1d727bddfba",
            measurementId: "G-514SH5LEKK"
        };
        
        // åˆå§‹åŒ– Firebase
        firebase.initializeApp(firebaseConfig);
        console.log('Firebase åˆå§‹åŒ–å®Œæˆï¼');
        
        // æ¸¬è©¦ Firebase Auth æ˜¯å¦å¯ç”¨
        console.log('Firebase Auth å¯ç”¨:', !!firebase.auth);
        console.log('Firebase Auth æ–¹æ³•:', Object.keys(firebase.auth()));
        
        // ã€é‡è¦ã€‘è¨­ç½®æŒä¹…åŒ– - å¿…é ˆåœ¨åˆå§‹åŒ–å¾Œç«‹å³è¨­ç½®
    firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL)
        .then(() => {
            console.log('âœ… Firebase æŒä¹…åŒ–è¨­ç½®å®Œæˆ');
        })
        .catch((error) => {
            console.error('âŒ æŒä¹…åŒ–è¨­ç½®å¤±æ•—:', error);
        });
    
        // ã€æœ€é‡è¦ã€‘åœ¨ä»»ä½• DOM äº‹ä»¶ä¹‹å‰è™•ç† redirect
        // é€™ç¢ºä¿ getRedirectResult åœ¨é é¢åŠ è¼‰æ™‚ç«‹å³æª¢æŸ¥
        let redirectUser = null;
        
        firebase.auth().getRedirectResult()
            .then((result) => {
                console.log('âœ… Redirect æª¢æŸ¥å®Œæˆ');
                if (result.user) {
                    console.log('â­ å¾ Google é‡å®šå‘ç™»å…¥æˆåŠŸ:', result.user.email);
                    redirectUser = result.user;
                    // ä¿å­˜åˆ°å…¨å±€è®Šæ•¸ä¾› script.js ä½¿ç”¨
                    window.redirectUser = result.user;
                } else {
                    console.log('â„¹ï¸ æ²’æœ‰ redirect ç”¨æˆ¶');
                }
            })
            .catch((error) => {
                console.error('âŒ Redirect æª¢æŸ¥å¤±æ•—:', error.code, error.message);
            });
    </script>

    <!-- Firebase Functions æš«æ™‚ç§»é™¤ -->
    <!-- <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-functions-compat.js"></script> -->
    <!-- Stripe -->
    <script src="https://js.stripe.com/v3/"></script>
    <script>
        // éœé»˜è™•ç† Stripe ç›¸é—œçš„ console éŒ¯èª¤
        window.addEventListener('error', function(e) {
            if (e.message && e.message.includes('stripe')) {
                console.log('â„¹ï¸ Stripe ç›¸é—œéŒ¯èª¤å·²éœé»˜è™•ç†');
                return true; // é˜»æ­¢éŒ¯èª¤é¡¯ç¤º
            }
        });
        
        // è™•ç†æœªæ•ç²çš„ Promise æ‹’çµ•
        window.addEventListener('unhandledrejection', function(e) {
            if (e.reason && e.reason.toString().includes('stripe')) {
                console.log('â„¹ï¸ Stripe Promise éŒ¯èª¤å·²éœé»˜è™•ç†');
                e.preventDefault();
            }
        });
    </script>

    <script src="js/translations.js"></script>
    <script src="js/script-login.js?v=1"></script>
</body>
</html>